import{r as t,c as e,h as o,H as s,g as i}from"./p-197d7af9.js";const n=class{constructor(o){t(this,o),this.ruxMenuWillOpen=e(this,"ruxmenuwillopen",7),this.ruxMenuWillClose=e(this,"ruxmenuwillclose",7),this.ruxMenuDidOpen=e(this,"ruxmenudidopen",7),this.ruxMenuDidClose=e(this,"ruxmenudidclose",7),this.open=!1}tieElements(){this._bindElements()}openMenu(){this._toggleOpenClose()}componentDidRender(){this.open&&this._setMenuPosition()}connectedCallback(){this._handleClick=this._handleClick.bind(this),this._handleOutsideClick=this._handleOutsideClick.bind(this),this._bindElements(),this._toggleOpenClose()}disconnectedCallback(){this.triggerEl&&this.triggerEl.removeEventListener("mousedown",this._handleClick)}async isOpen(){return this.open}async show(){return!this.open&&(this.open=!0,!0)}async close(){return!!this.open&&(this.open=!1,!0)}async toggle(){return this.open=!this.open,this.open}handleListen(){this.open=!1}_bindElements(){if(this.triggerEl)this.triggerEl.addEventListener("mousedown",this._handleClick);else{const t=document.querySelector(`[aria-controls="${this.el.id}"]`);t&&(this.triggerEl=t,this.triggerEl.addEventListener("mousedown",this._handleClick))}!this.anchorEl&&this.triggerEl?(this.anchorEl=this.triggerEl,this.anchorBounds=this.anchorEl.getBoundingClientRect()):this.anchorEl&&(this.anchorBounds=this.anchorEl.getBoundingClientRect()),this.menuBounds=this.el.getBoundingClientRect()}_setMenuPosition(){if(this.anchorEl&&this.anchorBounds&&this.menuBounds){let{anchorBounds:t,menuBounds:e}=this;t=this.anchorEl.getBoundingClientRect(),e=this.el.getBoundingClientRect();const o=parseInt(getComputedStyle(this.el,":after").height);let s,i,n;const r=8;e.width+t.left-r>window.innerWidth?(i=t.right-e.width,n=e.width-25):t.left-r>0?(i=t.left-r,n=10):(i=r,n=10),s=t.bottom+r/2+9.5,e.height+t.bottom+r>window.innerHeight?(s=t.top-e.height-o,this.el.classList.add("from-top")):this.el.classList.remove("from-top"),this.el.style.left=`${i}px`,this.el.style.top=`${s}px`,this.el.style.setProperty("--popup-menu-caret-left",`${n}px`)}}_handleClick(t){t.preventDefault(),this.open=!0}_handleOutsideClick(t){t.composedPath().includes(this.el)||(this.open=!1)}_toggleOpenClose(){var t,e;if(this.open){if(!this.anchorEl)return this.open=!1,void console.error("Unable to open pop up menu without an anchor element. See documentation");this.ruxMenuWillOpen.emit();const e=setTimeout((()=>{window.addEventListener("resize",(()=>this._setMenuPosition())),window.addEventListener("mousedown",this._handleOutsideClick),clearTimeout(e)}),10);null===(t=this.triggerEl)||void 0===t||t.removeEventListener("mousedown",this._handleClick),this.ruxMenuDidOpen.emit()}else this.ruxMenuWillClose.emit(),window.removeEventListener("mousedown",this._handleOutsideClick),window.removeEventListener("resize",this._setMenuPosition),null===(e=this.triggerEl)||void 0===e||e.addEventListener("mousedown",this._handleClick),this.ruxMenuDidClose.emit()}render(){return o(s,{"aria-hidden":this.open?"false":"true"},o("ul",{role:"menu","aria-expanded":`${this.open}`},o("slot",null)),o("slot",{name:"menu-end"}))}get el(){return i(this)}static get watchers(){return{triggerEl:["tieElements"],anchorEl:["tieElements"],open:["openMenu"]}}};n.style=':host{display:block;--popup-menu-background-color:var(--color-background);--popup-menu-border-color:var(--color-active);--popup-menu-caret-background-color:var(--color-active);--popup-menu-caret-left:2px;--popup-menu-caret-size:1.875rem;--popup-menu-transition-speed:0.1667s;opacity:0;margin:0;padding:0;position:absolute;pointer-events:none;color:var(--color-primary);background-color:var(--popup-menu-border-color);border:1px solid var(--popup-menu-border-color);border-top-width:4px;z-index:10000;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-radius:var(--radius-base);top:-9999rem;left:-9999rem;transition:opacity 0.1667s ease-out;filter:drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5))}:host([hidden]){display:none}:host([open]){pointer-events:auto;opacity:1;transition:opacity 0.1667s ease-in}:host::after{content:"";display:block;position:absolute;z-index:1;border:8px solid transparent;border-bottom:11px solid var(--popup-menu-caret-background-color);left:var(--popup-menu-caret-left, 2px);top:-1.4375rem}ul{position:relative;list-style:none;padding:0;margin:0;background-color:var(--popup-menu-background-color);z-index:2;border-radius:2px}li:last-of-type{border:none;border-radius:0 0 2px 2px}li:first-of-type{border:none;border-radius:2px 2px 0 0}:host(.from-top){border-top-width:1px;border-bottom-width:4px}:host(.from-top)::after{top:unset;bottom:-23px;transform:rotate(180deg)}';export{n as rux_pop_up_menu}